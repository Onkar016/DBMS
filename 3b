-- Create EMPLOYEE table
CREATE TABLE EMPLOYEE (
    ECODE INT PRIMARY KEY,
    NAME VARCHAR(50),
    DESIG VARCHAR(50),
    SGRADE CHAR(3),
    DOJ DATE,
    DOB DATE
);

-- Create SALGRADE table
CREATE TABLE SALGRADE (
    SGRADE CHAR(3) PRIMARY KEY,
    SALARY INT,
    HRA INT
);

-- Insert data into EMPLOYEE table
INSERT INTO EMPLOYEE (ECODE, NAME, DESIG, SGRADE, DOJ, DOB) VALUES (101, 'Vikrant', 'Executive', 'S03', '2003-03-23', '1980-01-13');
INSERT INTO EMPLOYEE (ECODE, NAME, DESIG, SGRADE, DOJ, DOB) VALUES (102, 'Ravi', 'Head-IT', 'S02', '2010-02-12', '1987-07-22');
INSERT INTO EMPLOYEE (ECODE, NAME, DESIG, SGRADE, DOJ, DOB) VALUES (103, 'John Cena', 'Receptionist', 'S03', '2009-06-24', '1983-02-24');
INSERT INTO EMPLOYEE (ECODE, NAME, DESIG, SGRADE, DOJ, DOB) VALUES (105, 'Azhar Ansari', 'GM', 'S02', '2009-08-11', '1984-03-03');
INSERT INTO EMPLOYEE (ECODE, NAME, DESIG, SGRADE, DOJ, DOB) VALUES (108, 'Priyam Sen', 'CEO', 'S01', '2004-12-29', '1982-01-19');

-- Insert data into SALGRADE table
INSERT INTO SALGRADE (SGRADE, SALARY, HRA) VALUES ('S01', 56000, 18000);
INSERT INTO SALGRADE (SGRADE, SALARY, HRA) VALUES ('S02', 32000, 12000);
INSERT INTO SALGRADE (SGRADE, SALARY, HRA) VALUES ('S03', 24000, 8000);

-- Queries for specified tasks

-- 1. Display NAME AND DESIG of employees whose Sgrade is either 'S02' or 'S03'
SELECT NAME, DESIG FROM EMPLOYEE WHERE SGRADE IN ('S02', 'S03');

-- 2. Display NAME, DESIG, SGRADE of employees who joined in the year 2009
SELECT NAME, DESIG, SGRADE FROM EMPLOYEE WHERE YEAR(DOJ) = 2009;

-- 3. Display all SGRADE, ANNUAL_SALARY from table SALGRADE where ANNUAL_SALARY = SALARY * 12
SELECT SGRADE, SALARY * 12 AS ANNUAL_SALARY FROM SALGRADE;

-- 4. Display the number of employees working in each SALGRADE from EMPLOYEE
SELECT SGRADE, COUNT(*) AS Number_of_Employees FROM EMPLOYEE GROUP BY SGRADE;

-- 5. Display NAME, DESIG, SALARY, HRA from EMPLOYEE and SALGRADE where SALARY is less than 50000
SELECT E.NAME, E.DESIG, S.SALARY, S.HRA 
FROM EMPLOYEE E 
JOIN SALGRADE S ON E.SGRADE = S.SGRADE 
WHERE S.SALARY < 50000;

-- 6. Select MIN(DOJ), MAX(DOB) from EMPLOYEE
SELECT MIN(DOJ) AS Earliest_Join_Date, MAX(DOB) AS Latest_Birth_Date FROM EMPLOYEE;

-- 7. Select SGrade, Salary + HRA from SALGRADE where Sgrade is 'S02'
SELECT SGRADE, SALARY + HRA AS Total_Compensation FROM SALGRADE WHERE SGRADE = 'S02';

-- 8. Select count of distinct Sgrade from EMPLOYEE
SELECT COUNT(DISTINCT SGRADE) AS Distinct_Grades FROM EMPLOYEE;

-- 9. Select sum(salary), avg(salary) from SALGRADE
SELECT SUM(SALARY) AS Total_Salary, AVG(SALARY) AS Average_Salary FROM SALGRADE;
